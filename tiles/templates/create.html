{% extends 'base.html' %}
{% block content %}
<h2 class="sr-only">Creat new composition</h2>
<div class="section section-input">
  <h2>Input</h2>
  <div class="images row" id="js-images"></div>
  <p>
    <button id="js-images-add">add</button>
  </p>
</div>
<div class="section section-composition">
  <h2>Composition</h2>
  <form action="javascript:void(0)">
    {% csrf_token %}
    <fieldset>
      <legend>Size</legend>
      <label for="js-width" class="sr-only">columns</label>
      <input type="number" id="js-width" min="0" class="size-input" />
      x
      <label for="js-height" class="sr-only">rows</label>
      <input type="number" id="js-height" min="0" class="size-input" />
    </fieldset>
    <fieldset>
      <legend>Mode</legend>
      <input
        type="radio"
        name="js-mode-preview"
        id="mode-final"
        value="0"
        checked="checked"
      />
      <label for="mode-final">Final</label>
      <input type="radio" name="js-mode-preview" id="mode-preview" value="1" />
      <label for="mode-preview">Preview</label>
    </fieldset>
    <fieldset>
      <button id="js-shuffle">shuffle</button>
    </fieldset>
  </form>
  <div class="composition" id="js-composition"></div>
</div>
<div class="section section-storage">
  <div class="storage-header">
    <h2>Drafts</h2>
    <button id="js-drafts-save">save draft</button>
  </div>
  <p class="storage-empty" id="js-drafts-empty">empty</p>
  <table class="storage-list" id="js-drafts-list"></table>
  <div class="storage-header">
    <h2>Published</h2>
    {% if user.is_authenticated %}
    <button id="js-published-submit">publish</button>
    {% endif %}
  </div>
  {% if user.is_authenticated %}
  <p class="storage-status" id="js-published-status"></p>
  <p class="storage-empty" id="js-published-empty">empty</p>
  <p class="storage-empty" id="js-published-loading" style="display: none">loading</p>
  <table class="storage-list" id="js-published-list"></table>
  {% else %}
  <p class="storage-empty">
    <a href="{% url 'accounts:login' %}?next={{ request.path }}">log in</a> to
    publish compositions
  </p>
  {% endif %}
</div>
{% endblock %}
{% block scripts %}
{{ data|json_script:'composition-data' }}
<script>
  import('/static/js/pages/create.js').then(Page =>
    Page.init(
      JSON.parse(document.getElementById('composition-data').textContent)
    )
  );
</script>
{% endblock %}
